<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Foehn Classification Based on a Two-Component Mixture Model — foehnix • foehnix</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Foehn Classification Based on a Two-Component Mixture Model — foehnix" />

<meta property="og:description" content="This is the main method of the foehnix package to estimate
two-component mixture models for automated foehn classification.
The default image plot of a foehnix object
is a Hovmoeller diagram." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/foehnix.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/foehnix.html">Foehnix Demo</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulation Examples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mixedmodel.html">Statistical Model</a>
    </li>
    <li>
      <a href="../articles/logisticregression.html">Logistic Regression (IWLS)</a>
    </li>
    <li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/retostauffer/Rfoehnix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Foehn Classification Based on a Two-Component Mixture Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/retostauffer/Rfoehnix/blob/master/R/foehnix.R'><code>R/foehnix.R</code></a>, <a href='https://github.com/retostauffer/Rfoehnix/blob/master/R/foehnix_functions.R'><code>R/foehnix_functions.R</code></a></small>
    <div class="hidden name"><code>foehnix.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is the main method of the foehnix package to estimate
two-component mixture models for automated foehn classification.</p>
<p>The default <code><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></code> plot of a <code>foehnix</code> object
is a Hovmoeller diagram.</p>
    
    </div>

    <pre class="usage"><span class='fu'>foehnix</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>switch</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>filter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='foehnix.control.html'>foehnix.control</a></span>(<span class='no'>family</span>, <span class='no'>switch</span>, <span class='no'>...</span>),
  <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>AIC</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>BIC</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='edf.html'>edf</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for foehnix</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>x</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='st'>"freq"</span>, <span class='kw'>deltat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>deltad</span> <span class='kw'>=</span> <span class='fl'>7L</span>,
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rev'>rev</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>gray.colors</a></span>(<span class='fl'>20</span>)), <span class='kw'>contours</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>contour.col</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>zlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class <code>formula</code> (or one that can be coerced
to that class): a symbolic description of the model to be fitted.  The
details of model specification are given under 'Details'.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a time series object of class <code>zoo</code> containing the
variables for the two-part mixture model.</p></td>
    </tr>
    <tr>
      <th>switch</th>
      <td><p>logical. If set to <code>TRUE</code> the two estimated components
will be switched. This is important if the covariate for the components
(left hand side of input <code>formula</code> is smaller for cases with foehn than
for cases without foehn, e.g., when using the temperature difference as main
covariate.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>a named list can be provided to apply a custom (simple) filter
to the observations on <code>data</code>. Can be used to e.g., prespecify a
specific wind sector for foehn winds. Please read the manual of the
<code><a href='foehnix_filter.html'>foehnix_filter</a></code> method for more details and examples.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>character (at the moment <code>"gaussian"</code> or <code>"logistic"</code>)
or an object of class <code>foehnix.family</code>.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>additional control arguments, see <code><a href='foehnix.control.html'>foehnix.control</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>forwarded to <code><a href='foehnix.control.html'>foehnix.control</a></code></p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>object of class <code>foehnix</code>.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>character string or a custom aggregation function. See 'Details'
section for more information.</p></td>
    </tr>
    <tr>
      <th>deltat</th>
      <td><p>integer, interval in seconds for the time of day axis. Has to be
a fraction of 86400 (24 hours in seconds). It <code>NuLL</code> (default) the
interval of the time series object will be used.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>vector of colors forwarded to <code>image.default</code>. By default
a gray scale color map is used.</p></td>
    </tr>
    <tr>
      <th>contours</th>
      <td><p>logical <code>TRUE</code> or <code>FALSE</code>, whether or not the
concours should be added.</p></td>
    </tr>
    <tr>
      <th>contour.col</th>
      <td><p>color for the contour lines, only used if <code>contours = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>zlim</th>
      <td><p>vector of two numeric values to manually specify the range of the
color map used.</p></td>
    </tr>
    <tr>
      <th>deltat</th>
      <td><p>integer, similar to <code>deltat</code>, the interval in days for the
grid on the x-axis. Default is <code>7L</code> (aggregate to weekly values).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments forwarded to the image and contour plot.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class <code>foehnix</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The two-component mixture model can be specified via formula object where
the left hand side of the formula contains the variable explaining the two
components (only one variable), the right hand side of the formula specifies
the concomitant variables (multiple variables allowed).  As an example:
let's assume that our zoo object '<code>data</code>' contains the following
columns:</p><ul>
<li><p><code>ff</code>: observed wind speed at target site</p></li>
<li><p><code>rh</code>: observed relative humidity at target site</p></li>
<li><p><code>diff_t</code>: temperature difference between target site and a station
          upstream of the foehn wind direction</p></li>
</ul>
    <p>The specification for <code>formula</code> could e.g. look as follows:</p><ul>
<li><p><code>ff ~ 1</code>: the two components of the mixture model will be
          based on the observed wind speed (<code>ff</code>), no concomitant
          variables are given (intercept only).</p></li>
<li><p><code>ff ~ rh</code>: similar to the specification above, but using
           observed relative humidity (<code>rh</code>) as concomitant.</p></li>
<li><p><code>ff ~ rh + diff_t</code>: as above but with an additional second
          concomitant variable (observed temperature difference, <code>diff_t</code>).</p></li>
<li><p><code>diff_t ~ ff + rh</code>: using temperature difference as the main
          variable for the two components while <code>ff</code> and <code>rh</code> are
          used as concomitants.</p></li>
</ul>
    <p>Note that these are just examples and have to be adjusted given data
availability, location, structure/names of the variables in the <code>data</code>
object.</p>
<p>An optional numeric vector of length <code>2</code> can be provided to filter the
data. If set, only times (rows in <code>data</code>) where the observed wind
direction <code>dd</code> lies within the wind sector specified.  For the examples
the wind direction <code>dd</code> is assumed to be in degrees, meteorological
definition (<code>90</code> = from east, <code>180</code> = from south, &#8230;).  The
following condition is used:</p><ul>
<li><p>If <code>windsector[1L] &lt; windsector[2L]</code>: use <code>data</code> where
          <code>data$dd &gt;= windsector[1L] &amp; data$dd &lt;= windsector[2L]</code>
          (e.g., <code>windsector = c(90, 270)</code> for south wind sector).</p></li>
<li><p>If <code>windsector[1L] &gt; windsector[2L]</code>: use <code>data</code> where
          <code>data$dd &gt;= windsector[1L] | data$dd &lt;= windsector[2L]</code>
          (e.g., <code>windsector = c(270, 90)</code> for north wind sector).</p></li>
</ul>
    <p>TODO: Details for lambda. If <code>"auto"</code> the default is <code>"loglik"</code>
except that the correlation between two or more covariates used in
<code>formula</code> exceeds <code>0.75</code> (both positive or negative). In this case
<code>lambda.min = "AIC"</code> will be used automatically with additional
regularization.  If <code>lambda.min = "loglik"</code> an unpenalized estimate
will be returned.  If <code>lambda.min</code> is either AIC or BIC a ridge penalty
(L2 penalty) is used. A fixed set of penalties will be tested. The one
minimising either the AIC or BIC criteria will be used for the foehn
classification model.</p>
<p>Plotting a Hovmoeller diagram based on the <code>zoo</code> time
series object of the <code>foehnix</code> classification. Different plot
types are available. The default functions (see list below) use <code>na.rm = TRUE</code>.</p>
<p>Input <code>FUN</code> can be one of the following character strings:</p><ul>
<li><p><code>mean</code>: mean probability.</p></li>
<li><p><code>freq</code>: plotting frequencies.</p></li>
<li><p><code>occ</code>: plotting occurance of foehn (where probability <code>&gt;= 0.5</code>).</p></li>
<li><p><code>noocc</code>: contrary to <code>occ</code>: occurance of no foehn (probability <code>&lt; 0.5</code>).</p></li>
</ul>
    <p><code>FUN</code> can also be a custom function used for time series aggregation
(see <code>aggregate.zoo</code>).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Plavcan D, Mayr GJ, Zeileis A (2014).
Automatic and Probabilistic Foehn Diagnosis with a Statistical Mixture Model.
<em>Journal of Applied Meteorology and Climatology</em>.
<b>53</b>(3), 652--659. doi: <a href='http://doi.org/10.1175/JAMC-D-13-0267.1'>10.1175/JAMC-D-13-0267.1</a></p>
<p>Gr\"un B, Leisch F (2007).
Fitting Finite Mixtures of Generalized Linear Regressions in <em>R</em>.
<em>Computational Statistics \&amp; Data Analysis</em>. <b>51</b>(11), 5247--5252.
doi: <a href='http://doi.org/10.1016/j.csda.2006.08.014'>10.1016/j.csda.2006.08.014</a></p>
<p>Gr\"un B, Leisch F (2008).
FlexMix Version 2: Finite Mixtures with Concomitant Variables and Varying and Constant Parameters.
<em>Journal of Statistical Software, Articles</em>.
<b>28</b>(4), 1--35. doi: <a href='http://doi.org/10.18637/jss.v028.i04'>10.18637/jss.v028.i04</a></p>
<p>Fraley C, Raftery AE (2002).
Model-Based Clustering, Discriminant Analysis, and Density Estimation.
<em>Journal of the American Statistical Association</em>.
<b>97</b>(458), 611--631. doi: <a href='http://doi.org/10.1198/016214502760047131'>10.1198/016214502760047131</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See <code><a href='foehnix_filter.html'>foehnix_filter</a></code> for more information about the
<code>filter</code> option.  See also: <code><a href='tsplot.html'>tsplot</a></code>, <code><a href='windrose.html'>windrose</a></code>.
TODO: filter should be renamed to filter.</p>
<p>Foehnix family objects: <code><a href='foehnix.family.html'>foehnix.family</a></code>.</p>
<p>S3 methods for <code>foehnix</code> objects:
<code><a href='plot.foehnix.html'>plot.foehnix</a></code>, <code><a href='predict.foehnix.html'>predict.foehnix</a></code>, <code><a href='fitted.foehnix.html'>fitted.foehnix</a></code>,
<code>print.foehnix</code>, <code><a href='windrose.html'>windrose.foehnix</a></code>, <code><a href='coef.foehnix.html'>coef.foehnix</a></code>,
...</p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

    <h2>Author</h2>
    <p>Reto Stauffer</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

