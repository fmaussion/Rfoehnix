<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • foehnix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/foehnix.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Demos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ellboegen.html">Ellbögen (Tyrol, A)</a>
    </li>
    <li>
      <a href="../articles/viejas.html">Viejas (California, USA)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/foehnix.html">Foehnix Demo</a>
    </li>
    <li>
      <a href="../articles/windrose.html">[Plot] Wind Rose</a>
    </li>
    <li>
      <a href="../articles/tsplot.html">[Plot] Time Series</a>
    </li>
    <li>
      <a href="../articles/image.html">[Plot] Hovmöller Diagram</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulation Examples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mixedmodel.html">Statistical Model</a>
    </li>
    <li>
      <a href="../articles/logisticregression.html">Logistic Regression (IWLS)</a>
    </li>
    <li>
      <a href="../articles/inference.html">Inference</a>
    </li>
    <li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/retostauffer/Rfoehnix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="viejas_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="viejas_files/jquery-1.12.4/jquery.min.js"></script><link href="viejas_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="viejas_files/leaflet-1.3.1/leaflet.js"></script><link href="viejas_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="viejas_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="viejas_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="viejas_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="viejas_files/leaflet-binding-2.0.2/leaflet.js"></script><script src="viejas_files/leaflet-providers-1.1.17/leaflet-providers.js"></script><script src="viejas_files/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/retostauffer/Rfoehnix/blob/master/vignettes/viejas.Rmd"><code>vignettes/viejas.Rmd</code></a></small>
      <div class="hidden name"><code>viejas.Rmd</code></div>

    </div>

    
    
<div id="htmlwidget-4932f27c4b1dd532d8c4" style="width:960px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4932f27c4b1dd532d8c4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPopups","args":[32.84559,-116.70437,"Station Viejas, 715 m a.m.s.l.",null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]},{"method":"addPopups","args":[32.9331,-116.528,"Station Lucky Five Ranch, 1445 m a.m.s.l.",null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]},{"method":"addProviderTiles","args":["OpenTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]}],"setView":[[32.889345,-116.616185],10.5,[]],"limits":{"lat":[32.84559,32.9331],"lng":[-116.70437,-116.528]}},"evals":[],"jsHooks":[]}</script><div id="loading-the-data-set" class="section level1">
<h1 class="hasAnchor">
<a href="#loading-the-data-set" class="anchor"></a>Loading the Data Set</h1>
<p><a href="references/demodata"><code><a href="../reference/demodata.html">demodata("california")</a></code></a> returns a data set which combines hourly meteorological observations for the two sites “Viejas Casino and Resort” and “Lucky Five Ranch” which serves as the crest station.</p>
<p>In addition, the potential temperature difference between the two stations is calculated by reducing the dry air temperature from “Lucky Five Ranch” to the height of “Viejas” (dry adiabatic lapse rate of 1K per 100m; stored on <code>diff_t</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/demodata.html">demodata</a></span>(<span class="st">"california"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(data, <span class="dt">n =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##                     air_temp relative_humidity wind_speed wind_direction
## 2012-01-01 00:00:00    23.89                25       1.34            227
## 2012-01-01 01:00:00    20.00                22       2.68             43
## 2012-01-01 02:00:00    19.44                15       4.02             35
##                     wind_gust crest_air_temp crest_relative_humidity
## 2012-01-01 00:00:00      2.68          16.67                      17
## 2012-01-01 01:00:00      4.02          14.44                      21
## 2012-01-01 02:00:00      6.70          13.89                      20
##                     crest_wind_speed crest_wind_direction crest_wind_gust
## 2012-01-01 00:00:00             5.81                   91            8.94
## 2012-01-01 01:00:00             0.90                   49            2.68
## 2012-01-01 02:00:00             0.90                  154            2.68
##                     diff_temp
## 2012-01-01 00:00:00      0.08
## 2012-01-01 01:00:00      1.74
## 2012-01-01 02:00:00      1.75</code></pre>
</div>
<div id="estimate-foehnix-model-for-foehn-classification" class="section level1">
<h1 class="hasAnchor">
<a href="#estimate-foehnix-model-for-foehn-classification" class="anchor"></a>Estimate <code>foehnix</code> Model for Foehn Classification</h1>
<p>We will use the following model assumptions:</p>
<ul>
<li>Main variable to separate “foehn” and “no foehn” cases: <code>diff_t</code> (potential temperature difference).</li>
<li>Concomitant variable: <code>wind_speed</code> (wind speed at target station Viejas).</li>
<li>Wind filter: the <code>wind_direction</code> at station Viejas has to lie within 305 and 160 degrees (easterly wind direction; downslope).</li>
<li>Option <code>switch = TRUE</code> as high <code>diff_temp</code> indicate stable stratification (no foehn).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod    &lt;-<span class="st"> </span><span class="kw"><a href="../reference/foehnix.html">foehnix</a></span>(diff_temp <span class="op">~</span><span class="st"> </span>wind_speed,
                  <span class="dt">data   =</span> data, <span class="dt">switch =</span> <span class="ot">TRUE</span>,
                  <span class="dt">filter =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">wind_direction =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">305</span>, <span class="dv">160</span>)))</code></pre></div>
<p>Which gives us the following model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod</code></pre></div>
<pre><code>## 
## Call: foehnix(formula = diff_temp ~ wind_speed, data = data, switch = TRUE, 
##     filter = list(wind_direction = c(305, 160)))
## 
## Number of observations (total)    61368 (184 due to inflation)
## Removed due to missing values      2205 (3.6 percent)
## Outside defined wind sector       27905 (45.5 percent)
## Used for classification           31258 (50.9 percent)
## 
## Climatological foehn occurance 9.32 percent (on n = 59163)
## Mean foehn probability 9.41 percent (on n = 59163)
## 
## Log-likelihood: -86157.2, 6 effective degrees of freedom
## Corresponding AIC = 172326.5, BIC = 172376.6
## Time required for model estimation: 7.0 seconds
## 
## Use summary(object, detailed = TRUE) to get additional test statistics.</code></pre>
</div>
<div id="time-series-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#time-series-plot" class="anchor"></a>Time Series Plot</h1>
<p>The Californian demo data set has non-standard variable names (by purpose). Thus, when calling <code>tsplot</code> (time series plot) we do have to manually specify these names.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Some smaller quality issues in the data (should not be a big deal)</span>
start &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2012-01-01"</span>)
end   &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">"2012-01-15"</span>)

<span class="co"># As we dont have the standard names: re-specify the</span>
<span class="co"># names for this plot (new feature).</span>
<span class="kw"><a href="../reference/tsplot.html">tsplot</a></span>(mod, <span class="dt">style =</span> <span class="st">"advanced"</span>, <span class="dt">diff_t =</span> <span class="st">"diff_temp"</span>,
       <span class="dt">t   =</span> <span class="st">"air_temp"</span>,   <span class="dt">crest_t   =</span> <span class="st">"crest_air_temp"</span>,
       <span class="dt">dd  =</span> <span class="st">"wind_dir"</span>,   <span class="dt">crest_dd  =</span> <span class="st">"crest_wind_dir"</span>,
       <span class="dt">ff  =</span> <span class="st">"wind_speed"</span>, <span class="dt">crest_ff  =</span> <span class="st">"crest_wind_speed"</span>,
       <span class="dt">ffx =</span> <span class="st">"wind_gust"</span>,  <span class="dt">crest_ffx =</span> <span class="st">"crest_wind_gust"</span>,
       <span class="dt">rh =</span> <span class="st">"relative_humidity"</span>,
       <span class="dt">start =</span> start, <span class="dt">end =</span> end)</code></pre></div>
<p><img src="viejas_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<div id="model-coefficients" class="section level3">
<h3 class="hasAnchor">
<a href="#model-coefficients" class="anchor"></a>Model coefficients</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(mod)</code></pre></div>
<pre><code>## Coefficients of foehnix model
## Model formula:           diff_temp ~ wind_speed
## foehnix family of class: Gaussian
## 
## Coefficients
##         mu1      sigma1         mu2      sigma2 (Intercept)  wind_speed 
##   9.1263349   4.0800074   0.2234891   1.4175373  -7.8449992   3.3753179</code></pre>
</div>
</div>
<div id="graphical-model-assessment" class="section level1">
<h1 class="hasAnchor">
<a href="#graphical-model-assessment" class="anchor"></a>Graphical Model Assessment</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Log-likelihood contribution</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mod, <span class="dt">which =</span> 2L)</code></pre></div>
<p><img src="viejas_files/figure-html/plot_mod-1.png" width="1152"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient path</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mod, <span class="dt">which =</span> 3L)</code></pre></div>
<p><img src="viejas_files/figure-html/plot_mod-2.png" width="1152"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histogram</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mod, <span class="dt">which =</span> 4L)</code></pre></div>
<p><img src="viejas_files/figure-html/plot_mod-3.png" width="1152"></p>
</div>
<div id="wind-rose-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#wind-rose-plot" class="anchor"></a>Wind Rose Plot</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/windrose.html">windrose</a></span>(mod, <span class="dt">dd =</span> <span class="st">"wind_direction"</span>, <span class="dt">ff =</span> <span class="st">"wind_speed"</span>,
         <span class="dt">type =</span> <span class="st">"hist"</span>, <span class="dt">which =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"foehn"</span>, <span class="st">"nofoehn"</span>),
         <span class="dt">windsector =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">305</span>, <span class="dv">160</span>)))</code></pre></div>
<p><img src="viejas_files/figure-html/windrose-1.png" width="700"></p>
</div>
<div id="hovmoler-diagram" class="section level1">
<h1 class="hasAnchor">
<a href="#hovmoler-diagram" class="anchor"></a>Hovmöler Diagram</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Default plot</span>
<span class="kw"><a href="../reference/image.html">image</a></span>(mod)</code></pre></div>
<p><img src="viejas_files/figure-html/image_1-1.png" width="1152"></p>
<p>Customized plot which shows the “foehn frequency” for the interesting time period from August to April with custom colors and additional contour lines and custom aggregation period (two-weeks, 3-hourly).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/image.html">image</a></span>(mod, <span class="dt">deltad =</span> 14L, <span class="dt">deltat =</span> <span class="dv">3</span><span class="op">*</span><span class="dv">3600</span>, <span class="dt">contours =</span> <span class="ot">TRUE</span>,
      <span class="dt">contour.col =</span> <span class="st">"white"</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">labcex =</span> <span class="fl">1.5</span>,
      <span class="dt">col =</span> colorspace<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/colorspace/topics/hcl_palettes">sequential_hcl</a></span>(<span class="dv">51</span>, <span class="st">"Purple-Yellow"</span>, <span class="dt">rev =</span> <span class="ot">TRUE</span>),
      <span class="dt">xlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">212</span>, <span class="dv">119</span>), <span class="dt">zlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.4</span>))</code></pre></div>
<p><img src="viejas_files/figure-html/image_2-1.png" width="1152"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#loading-the-data-set">Loading the Data Set</a></li>
      <li><a href="#estimate-foehnix-model-for-foehn-classification">Estimate <code>foehnix</code> Model for Foehn Classification</a></li>
      <li><a href="#time-series-plot">Time Series Plot</a></li>
      <li><a href="#graphical-model-assessment">Graphical Model Assessment</a></li>
      <li><a href="#wind-rose-plot">Wind Rose Plot</a></li>
      <li><a href="#hovmoler-diagram">Hovmöler Diagram</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
