<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> â€¢ foehnix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/foehnix.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/foehnix.html">Foehnix Demo</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulation Examples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/retostauffer/Rfoehnix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/retostauffer/Rfoehnix/blob/master/vignettes/foehnix.Rmd"><code>vignettes/foehnix.Rmd</code></a></small>
      <div class="hidden name"><code>foehnix.Rmd</code></div>

    </div>

    
    
<div id="foehnix-demo" class="section level2">
<h2 class="hasAnchor">
<a href="#foehnix-demo" class="anchor"></a>Foehnix Demo</h2>
<p>This page shows a <em>real world</em> demo of the automated foehn classification method <strong>foehnix</strong> based on meteorological observations from two sites in Tyrol, Austria. One station is located in the Brenner valley south of Innsbruck on 1080 meters above mean sea level, the second station is located close to the main alpine ridge on 2107 meters above mean sea level (see <code><a href="../reference/ellboegen.html">?ellboegen</a></code>/<code><a href="../reference/ellboegen.html">?sattelberg</a></code> for details).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"ellboegen"</span>); <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"sattelberg"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(ellboegen);   <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sattelberg)</code></pre></div>
<pre><code>##    timestamp  dd  ff     p rh    t
## 1 1263805200 338 1.2 899.8 75 -0.9
## 2 1263808800  18 0.1 899.9 66  0.2
## 3 1263812400 344 0.8 899.1 63  0.7
## 4 1263816000 303 2.4 898.8 60  0.7
## 5 1263819600 292 2.8 898.5 57  1.9
## 6 1263823200 316 1.6 898.6 70  0.3</code></pre>
<pre><code>##    timestamp  dd  ff     p rh    t
## 1 1263805200   3 5.6 787.7 93 -8.7
## 2 1263808800 344 5.3 787.9 90 -8.0
## 3 1263812400 360 6.0 787.3 80 -7.7
## 4 1263816000 357 6.5 786.8 77 -7.3
## 5 1263819600 358 8.7 786.6 78 -7.2
## 6 1263823200 352 7.6 786.8 80 -7.2</code></pre>
<p>This example shows how to perform foehn classification for Ellboegen using the information of the Sattelberg station as additional source of information. The Sattelberg station is located south of Ellboegen close to the alpine crest and thus, during foehn events, measuring the upstream air mass decending down on the north side of the Alps.</p>
<div id="south-foehn-classification-for-ellboegen" class="section level3">
<h3 class="hasAnchor">
<a href="#south-foehn-classification-for-ellboegen" class="anchor"></a>South Foehn Classification for Ellboegen</h3>
<p>To perform the classification we first of all have to prepare our data sets. <code><a href="../reference/foehnix.html">foehnix(...)</a></code> expects the input to be of class <code>zoo</code> (zoo time series object; based on the  <code>zoo</code> package). Thus, after loading our example data sets, we first have to convert the <code>data.frame</code>s into valid <code>zoo</code> objects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Loading observations (data.frame), convert to zoo</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"ellboegen"</span>, <span class="dt">package =</span> <span class="st">"foehnix"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"sattelberg"</span>, <span class="dt">package =</span> <span class="st">"foehnix"</span>)
timefun    &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(x,  <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>)
ellboegen  &lt;-<span class="st"> </span><span class="kw">zoo</span>(ellboegen[,<span class="op">-</span><span class="dv">1</span>],  <span class="kw">timefun</span>(ellboegen<span class="op">$</span>timestamp))
sattelberg &lt;-<span class="st"> </span><span class="kw">zoo</span>(sattelberg[,<span class="op">-</span><span class="dv">1</span>], <span class="kw">timefun</span>(sattelberg<span class="op">$</span>timestamp))</code></pre></div>
<p>As we want to use information from both stations: rename the variables of the <code>sattelberg</code> object and combine the two data sets into one <code>zoo</code> object called <code>data</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Modify sattelberg variable names (crest_ identifies Sattelberg</span>
<span class="co"># observations, our crest station) and combine both data sets.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sattelberg) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"crest_"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sattelberg))
data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(ellboegen, sattelberg)</code></pre></div>
<p>In addition we are calculating the potential temperature difference between the two sites using a dry adiabatic lapse rate of one 10 degrees Celsius per 1000 meters. The difference in altitude between the two stations is 1027 meters which yields:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Dry adiabatic temperature difference between </span>
<span class="co"># Sattelberg (data$crest_t) and Ellboegen (data$t) corrected by</span>
<span class="co"># 1027/10 degrees.</span>
data<span class="op">$</span>diff_t &lt;-<span class="st"> </span>data<span class="op">$</span>crest_t <span class="op">+</span><span class="st"> </span><span class="fl">10.27</span> <span class="op">-</span><span class="st"> </span>data<span class="op">$</span>t</code></pre></div>
<p>South foehn flow at the valley station in Ellboegen has a wind direction of about 133 degrees. We are using a (relatively weak) wind direction filter with a wind sector of +/-90 degrees around 133 degrees. For the classification only observations/times are used where the corresponding wind direction (<code>dd</code>) lies within the wind sector <code>&gt;=43</code> and <code>&lt;= 223</code> (180 degrees sector). In addition we can make use of the information provided by the crest station (Sattelberg) in several ways:</p>
<ol style="list-style-type: decimal">
<li>We use the temperature difference between the two stations as main variable for the classification (<code>diff_t</code>).</li>
<li>define wind sector filter at the target station (Ellboegen). Only use observations with a wind direction (<code>dd</code>) inside the wind sector of <code>&gt;=43</code> and <code>&lt;=223</code> degrees for classification (<code>dd = c(43, 223)</code>).</li>
<li>specify a second filter such that only observations are used for classification where the crest station shows a sutherly flow (wind direction within <code>&gt;= 90</code> and <code>&lt;= 270</code>, <code>sat_dd = c(90, 270)</code>).</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Specify our wind filter rule(s)</span>
windfilter &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">dd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">43</span>, <span class="dv">223</span>), <span class="dt">crest_dd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">90</span>, <span class="dv">270</span>))

<span class="co"># Estimate the mixture model for automated foehn classification</span>
mod1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/foehnix.html">foehnix</a></span>(diff_t <span class="op">~</span><span class="st"> </span>ff, <span class="dt">data =</span> data, <span class="dt">windfilter =</span> windfilter, <span class="dt">switch =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Letâ€™s check the estimated model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(mod1)</code></pre></div>
<pre><code>## 
## Call: foehnix(formula = diff_t ~ ff, data = data, switch = TRUE, windfilter = windfilter)
## 
## 
## Number of observations (total)    71356
## Removed due to missing values         0 (0.0 percent)
## Outside defined wind sector       53726 (75.3 percent)
## Used for classification           17630 (24.7 percent)
## 
## Climatological foehn occurance 11.48 percent (on n = 71356)
## Mean foehn probability 11.35 percent (on n = 71356)
## 
## Log-likelihood: -40649.7, 6 effective degrees of freedom
## Corresponding AIC = 81311.5, BIC = 81358.1
## Time required for model estimation: 1.5 seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(mod1))</code></pre></div>
<pre><code>## Coefficients of foehnix model
## Model formula:           diff_t ~ ff
## foehnix family of class: Gaussian
## 
## Coefficients
##         mu1      sigma1         mu2      sigma2 (Intercept)          ff 
##    5.987324    2.757988    1.285962    1.238097   -5.975235    1.010610</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#foehnix-demo">Foehnix Demo</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
